@using System.Text
@using Property365.Web.Components.Rendering
@using Microsoft.JSInterop
@inherits Property365HtmlEditorButtonBase
@inject DialogService DialogService
@inject IJSRuntime JSRuntime

<EditorButton Click=@OnClick Icon="insert_photo" Title=@Title />

@code {
    protected override async Task OnClick()
    {
        await Editor.SaveSelectionAsync();

        var uploadHeaders = Editor.UploadHeaders ?? new Dictionary<string, string>();

        Attributes = await JSRuntime.InvokeAsync<ImageAttributes>("Property365Components.selectionAttributes", "img", new[] {"src", "alt",
"width", "height"});

        var result = await DialogService.OpenAsync(Title, ds =>
    @<div class="rz-html-editor-dialog">
        <div class="rz-html-editor-dialog-item">
            <label>@SelectText</label>
            <Property365Upload ChooseText=@UploadChooseText @ref=@FileUpload Url=@Editor.UploadUrl Auto="false" Accept="image/*"
            style="width: 100%" Complete="OnUploadComplete">
                @foreach (var header in uploadHeaders)
                        {
                            <Property365UploadHeader Name=@header.Key Value=@header.Value />
                        }
                    </Property365Upload>
                </div>
                <div class="rz-html-editor-dialog-item">
                    <label>@WidthText</label>
                    <Property365TextBox @bind-Value=@Attributes.Width style="width: 100%" />
                </div>
                <div class="rz-html-editor-dialog-item">
                    <label>@HeightText</label>
                    <Property365TextBox @bind-Value=@Attributes.Height style="width: 100%" />
                </div>
                <div class="rz-html-editor-dialog-item">
                    <label>@UrlText</label>
                    <Property365TextBox @bind-Value=@Attributes.Src style="width: 100%" />
                </div>
                <div class="rz-html-editor-dialog-item">
                    <label>@AltText</label>
                    <Property365TextBox @bind-Value=@Attributes.Alt style="width: 100%" />
                </div>
                <div class="rz-html-editor-dialog-buttons">
                    <Property365Button Text=@OkText Click="OnSubmit" />
                    <Property365Button Text=@CancelText Click="()=> ds.Close(false)" ButtonStyle="ButtonStyle.Secondary" />
                </div>
            </div>
    );
    }
}
