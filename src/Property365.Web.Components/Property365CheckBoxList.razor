@using System.Linq
@using System.Collections
@using Property365.Web.Components
@using Property365.Web.Components.Rendering
@using Microsoft.AspNetCore.Components.Forms
@typeparam TValue
@inherits FormComponent<IEnumerable<TValue>>

@if (Items != null)
{
    <CascadingValue Value=this>
        @Items
    </CascadingValue>
}
@if (Visible)
{
    <div @ref="@Element" style="@Style" @attributes="Attributes" class="@GetCssClass()" id="@GetId()">
        @foreach (var item in allItems.Where(i => i.Visible))
        {
            <div class="flex flex-row align-center" @onclick="@(args => SelectItem(item))" @attributes="item.Attributes" style="@item.Style">
                <div class="inline-block align-middle relative w-5 min-w-5 h-5" @onkeypress="@(async args => { if (args.Code == "Space") { await SelectItem(item); } })"  tabindex="@TabIndex">
                    <div class="opacity-0 h-0 overflow-hidden">
                        <input type="checkbox" name="@Name" value="@item.Value" disabled="@Disabled" tabindex="-1">
                    </div>
                    <div class=@ItemClassList(item)>
                        <span class=@IconClassList(item)></span>
                    </div>
                </div>
                <label class="rz-chkbox-label">@item.Text</label>
            </div>
        }
    </div>
}
